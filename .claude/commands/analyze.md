# /analyze - 多次元コード分析

**目的**: コード、アーキテクチャ、セキュリティ、パフォーマンスの包括的な分析

## 概要

`/analyze`コマンドは、Pythonプロジェクトの様々な側面を分析し、エビデンスベースの改善提案を提供します。

## 使用方法

```bash
/analyze [オプション] [対象]
```

## オプション

### --code
コード品質の分析を実行：
- 命名規則の一貫性
- 関数・クラスの複雑性（サイクロマティック複雑性）
- DRY原則の遵守状況
- 型ヒントのカバレッジ
- docstringの品質

### --arch
アーキテクチャの分析：
- レイヤー間の結合度
- 依存関係の方向性
- 設計パターンの適用状況
- モジュール間の責務分離
- スケーラビリティの評価

### --security
セキュリティ監査：
- OWASP Top 10の脆弱性チェック
- 認証・認可の実装確認
- 入力検証とサニタイゼーション
- 暗号化とデータ保護
- エラーハンドリングの安全性

### --perf
パフォーマンス分析：
- アルゴリズムの時間計算量
- メモリ使用効率
- I/O操作の最適化機会
- データベースクエリの効率性
- キャッシング機会の特定

### 分析深度フラグ
- `--think`: 標準的な分析（デフォルト）
- `--think-hard`: 深い分析
- `--ultrathink`: 最も詳細な分析

## 実行例

### 基本的な使用
```bash
# カレントディレクトリのコード品質分析
/analyze --code

# 特定ファイルのセキュリティ監査
/analyze --security src/auth/

# 全体的なアーキテクチャ分析
/analyze --arch --think-hard
```

### 複合分析
```bash
# コードとセキュリティの包括的分析
/analyze --code --security --think-hard

# パフォーマンスボトルネックの特定
/analyze --perf --ultrathink src/core/
```

## 出力形式

分析結果は以下の形式で提供されます：

```yaml
分析サマリー:
  対象: [分析対象のパス]
  実行時間: [分析にかかった時間]

発見事項:
  重大度: CRITICAL|HIGH|MEDIUM|LOW
  カテゴリ: [問題のカテゴリ]
  場所: [ファイル:行番号]
  説明: [問題の詳細]
  証拠: [メトリクスや具体例]
  推奨対応: [改善案]

メトリクス:
  コード品質スコア: [0-100]
  セキュリティスコア: [0-100]
  パフォーマンススコア: [0-100]
  テストカバレッジ: [パーセンテージ]
```

## 既存ツールとの連携

`/analyze`は以下のツールと連携して動作します：

- `mypy`: 型チェックの結果を統合
- `ruff`: リンター出力を分析に含める
- `bandit`: セキュリティ問題の検出
- `pytest`: テストカバレッジの確認

## 注意事項

- 大規模なコードベースでは`--ultrathink`の使用に時間がかかる場合があります
- セキュリティ分析は補完的なツールとして使用し、専門的なセキュリティ監査の代替にはなりません
- パフォーマンス分析は静的解析に基づくため、実際のベンチマークと併用してください
