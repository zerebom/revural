# /task - 複雑なタスクの管理

**目的**: 大規模な機能開発やリファクタリングのタスク管理とトラッキング

## 概要

`/task`コマンドは、複雑な開発タスクを自動的にサブタスクに分解し、進捗を追跡し、セッション間でのコンテキストを保持します。

## 使用方法

```bash
/task:<操作> [引数]
```

## 操作

### :create
新しいタスクを作成し、自動的にサブタスクに分解：
```bash
/task:create "OAuth 2.0認証システムの実装"
```

作成時の自動処理：
- タスクの複雑性分析
- サブタスクへの自動分解
- 依存関係の特定
- 工数の見積もり
- マイルストーンの設定

### :status
タスクの現在の状態を確認：
```bash
/task:status task-id
```

表示される情報：
- 全体の進捗率
- 完了したサブタスク
- 現在作業中の項目
- ブロッカーの有無
- 残り作業の見積もり

### :resume
中断したタスクを再開：
```bash
/task:resume task-id
```

復元される内容：
- 前回の作業状態
- 編集中のファイル
- 実行したコマンド履歴
- 意思決定の記録
- テスト結果

### :update
タスクに新しい情報を追加：
```bash
/task:update task-id "ライブラリの競合を発見、代替案を検討中"
```

### :complete
タスクを完了としてマーク：
```bash
/task:complete task-id
```

完了時の処理：
- 成果物のサマリー生成
- ドキュメントの自動作成
- 学習事項の記録
- アーカイブの作成

## タスク構造

```yaml
タスク:
  ID: task-2024-01-oauth
  タイトル: OAuth 2.0認証システムの実装
  状態: in_progress
  作成日時: 2024-01-15 10:00:00

  受け入れ条件:
    - Google/GitHub OAuth対応
    - リフレッシュトークンの実装
    - セキュアなトークン保存

  技術要件:
    - Python 3.12+
    - FastAPI
    - SQLAlchemy
    - JWT

  サブタスク:
    - ID: subtask-1
      タイトル: OAuthプロバイダー設定
      状態: completed
      工数: 2h

    - ID: subtask-2
      タイトル: 認証フローの実装
      状態: in_progress
      工数: 4h
      依存: subtask-1

    - ID: subtask-3
      タイトル: トークン管理
      状態: pending
      工数: 3h
      依存: subtask-2
```

## 自動機能

### スマートな分解
タスクの説明から自動的に：
- 必要な機能を特定
- 技術的な要件を抽出
- 適切な粒度でサブタスク化
- 依存関係を設定
- 現実的な工数を見積もり

### コンテキスト保存
作業中の情報を自動保存：
- 編集したファイルのリスト
- 実行したコマンド
- テスト結果
- エラーと解決方法
- 意思決定の理由

### 進捗追跡
リアルタイムで更新：
- TodoWriteとの連携
- gitコミットとの紐付け
- テスト結果の記録
- メトリクスの収集

## セッション管理

### 自動復旧
セッションが中断された場合：
1. 未完了タスクを自動検出
2. 前回の状態を復元
3. 作業継続の提案

### 状態の永続化
`.claude/tasks/`ディレクトリに保存：
- タスク定義
- 進捗情報
- コンテキストデータ
- 成果物

## 統合機能

### TodoWriteとの連携
- サブタスクを自動的にTodoWriteに追加
- 進捗を同期
- 完了状態を反映

### Git連携
- コミットメッセージにタスクIDを含める
- ブランチ名の自動生成
- マージ時の自動更新

### テスト連携
- テスト結果をタスクに記録
- カバレッジの追跡
- 品質メトリクスの収集

## ベストプラクティス

1. **明確な説明**: タスク作成時は具体的な要件を記載
2. **定期的な更新**: 発見や決定事項は都度更新
3. **小さなコミット**: サブタスク単位でコミット
4. **テストの維持**: 各サブタスク完了時にテスト実行
5. **ドキュメント化**: 重要な決定は理由と共に記録

## 出力例

```yaml
タスクサマリー:
  ID: task-2024-01-oauth
  進捗: 65%
  経過時間: 8.5h / 見積もり12h

完了サブタスク:
  ✓ OAuthプロバイダー設定 (2h)
  ✓ 基本認証フロー (3h)
  ✓ データベーススキーマ (1.5h)

作業中:
  → トークンリフレッシュ機能 (2h, 50%完了)

保留中:
  - セキュリティテスト (2h)
  - ドキュメント作成 (1.5h)

ブロッカー:
  なし

次のアクション:
  トークンリフレッシュのテストケース作成
```
