# Google Cloud ãƒãƒƒã‚«ã‚½ãƒ³ ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰

## ğŸ“‹ è¦ä»¶ç¢ºèª

### Google Cloud ãƒãƒƒã‚«ã‚½ãƒ³å¿…é ˆæ¡ä»¶

#### âœ… Google Cloud AIæŠ€è¡“ã®åˆ©ç”¨ (æ—¢ã«é©åˆ)
- **ADK (Agent Development Kit)**: âœ… å®Ÿè£…æ¸ˆã¿
- **Gemini API**: âœ… gemini-2.5-flash-liteä½¿ç”¨ä¸­
- **ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ **: âœ… 9ç¨®é¡ã®å°‚é–€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

#### âŒ Google Cloud ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®åˆ©ç”¨ (è¦å®Ÿè£…)
ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š
- App Engine
- Google Compute Engine
- Google Kubernetes Engine (GKE)
- **Cloud Run** â† æ¨å¥¨
- Cloud Functions
- Cloud TPU / GPU

## ğŸ—ï¸ ç¾åœ¨ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ§‹æˆ
```
â”œâ”€â”€ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: FastAPI (Python 3.12+)
â”‚   â”œâ”€â”€ AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ: 9ç¨®é¡å°‚é–€å®¶AI
â”‚   â”œâ”€â”€ API: ãƒ¬ãƒ“ãƒ¥ãƒ¼ç®¡ç†ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé¸æŠ
â”‚   â””â”€â”€ ãƒãƒ¼ãƒˆ: 8000
â”œâ”€â”€ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: Next.js 15.5.2
â”‚   â”œâ”€â”€ UI: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé¸æŠã€çµæœè¡¨ç¤º
â”‚   â””â”€â”€ ãƒãƒ¼ãƒˆ: 3000
â””â”€â”€ AIçµ±åˆ: Google ADK + Gemini API
```

### å°‚é–€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ (9ç¨®é¡)
1. **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢AI** - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰è¨­è¨ˆãƒ»APIå°‚é–€
2. **UXãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼AI** - ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“è¨­è¨ˆå°‚é–€
3. **QAãƒ†ã‚¹ã‚¿ãƒ¼AI** - å“è³ªä¿è¨¼ãƒ»ãƒ†ã‚¹ãƒˆæˆ¦ç•¥å°‚é–€
4. **ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼AI** - ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ãƒ»æˆ¦ç•¥å°‚é–€
5. **ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆAI** - åŠ¹æœæ¸¬å®šãƒ»åˆ†æå°‚é–€
6. **UXãƒ©ã‚¤ã‚¿ãƒ¼AI** - ãƒã‚¤ã‚¯ãƒ­ã‚³ãƒ”ãƒ¼ãƒ»ãƒ–ãƒ©ãƒ³ãƒ‰ãƒœã‚¤ã‚¹å°‚é–€
7. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£AI** - è„†å¼±æ€§è¨ºæ–­ãƒ»å€‹äººæƒ…å ±ä¿è­·å°‚é–€
8. **ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°AI** - GTMæˆ¦ç•¥ãƒ»ç«¶åˆåˆ†æå°‚é–€
9. **ãƒªãƒ¼ã‚¬ãƒ«AI** - æ³•å‹™ãƒ»ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å°‚é–€

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤è¨ˆç”»

### æ¨å¥¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£: Cloud Run
```
Internet â†’ Cloud Load Balancer â†’ Cloud Run Services
                                  â”œâ”€â”€ Frontend Service (Next.js)
                                  â””â”€â”€ Backend Service (FastAPI)
                                       â””â”€â”€ Gemini API
```

### åˆ©ç‚¹
- ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ï¼ˆå¾“é‡èª²é‡‘ï¼‰
- è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- ç„¡æ–™æ : æœˆ200ä¸‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
- HTTPSè‡ªå‹•æä¾›

## ğŸ“¦ å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«

### 1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ Dockerfile
```dockerfile
# backend.Dockerfile
FROM python:3.12-slim

WORKDIR /app

# Install uv
RUN pip install uv

# Copy dependency files
COPY pyproject.toml uv.lock ./

# Install dependencies
RUN uv sync --frozen --no-dev

# Copy source code
COPY src/ ./src/

# Set environment variables
ENV PORT=8080
ENV PYTHONPATH=/app/src

# Expose port
EXPOSE 8080

# Start the application
CMD ["uv", "run", "uvicorn", "src.hibikasu_agent.api.main:app", "--host", "0.0.0.0", "--port", "8080"]
```

### 2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ Dockerfile
```dockerfile
# frontend.Dockerfile
FROM node:18-alpine

WORKDIR /app

# Install pnpm
RUN npm install -g pnpm

# Copy package files
COPY frontend/package.json frontend/pnpm-lock.yaml ./

# Install dependencies
RUN pnpm install --frozen-lockfile --production

# Copy source code
COPY frontend/ .

# Build the application
RUN pnpm build

# Expose port
EXPOSE 3000

# Start the application
CMD ["pnpm", "start"]
```

### 3. Next.jsè¨­å®šæ›´æ–°
```javascript
// frontend/next.config.js
/** @type {import('next').NextConfig} */
const nextConfig = {
  output: 'standalone',
  env: {
    NEXT_PUBLIC_API_BASE_URL: process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:8000'
  },
  // Cloud Runç”¨ã®æœ€é©åŒ–
  experimental: {
    outputFileTracingRoot: process.cwd(),
  }
}

module.exports = nextConfig
```

### 4. Cloud Buildè¨­å®š
```yaml
# cloudbuild.yaml
steps:
  # Build backend
  - name: 'gcr.io/cloud-builders/docker'
    args: [
      'build',
      '-t', 'gcr.io/$PROJECT_ID/hibikasu-backend:$COMMIT_SHA',
      '-f', 'backend.Dockerfile',
      '.'
    ]

  # Build frontend
  - name: 'gcr.io/cloud-builders/docker'
    args: [
      'build',
      '-t', 'gcr.io/$PROJECT_ID/hibikasu-frontend:$COMMIT_SHA',
      '-f', 'frontend.Dockerfile',
      '.'
    ]

  # Deploy backend to Cloud Run
  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    entrypoint: gcloud
    args: [
      'run', 'deploy', 'hibikasu-backend',
      '--image', 'gcr.io/$PROJECT_ID/hibikasu-backend:$COMMIT_SHA',
      '--region', 'asia-northeast1',
      '--platform', 'managed',
      '--allow-unauthenticated',
      '--set-env-vars', 'GOOGLE_CLOUD_PROJECT=$PROJECT_ID'
    ]

  # Deploy frontend to Cloud Run
  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    entrypoint: gcloud
    args: [
      'run', 'deploy', 'hibikasu-frontend',
      '--image', 'gcr.io/$PROJECT_ID/hibikasu-frontend:$COMMIT_SHA',
      '--region', 'asia-northeast1',
      '--platform', 'managed',
      '--allow-unauthenticated',
      '--set-env-vars', 'NEXT_PUBLIC_API_BASE_URL=https://hibikasu-backend-xxx.a.run.app'
    ]

images:
  - 'gcr.io/$PROJECT_ID/hibikasu-backend:$COMMIT_SHA'
  - 'gcr.io/$PROJECT_ID/hibikasu-frontend:$COMMIT_SHA'
```

## ğŸ”§ ç’°å¢ƒè¨­å®š

### å¿…è¦ãªç’°å¢ƒå¤‰æ•°

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
```bash
GOOGLE_API_KEY=your_gemini_api_key
GOOGLE_CLOUD_PROJECT=your_project_id
CORS_ALLOW_ORIGINS=https://your-frontend-url.a.run.app
HIBIKASU_LOG_LEVEL=INFO
ADK_MODEL=gemini-2.5-flash-lite
```

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
```bash
NEXT_PUBLIC_API_BASE_URL=https://your-backend-url.a.run.app
```

### Secret Managerä½¿ç”¨ (æ¨å¥¨)
```bash
# Gemini API Keyã‚’ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¨ã—ã¦ä¿å­˜
gcloud secrets create gemini-api-key --data-file=-
echo "your_actual_api_key_here" | gcloud secrets create gemini-api-key --data-file=-

# Cloud Runã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯
gcloud secrets add-iam-policy-binding gemini-api-key \
    --member="serviceAccount:your-service-account@your-project.iam.gserviceaccount.com" \
    --role="roles/secretmanager.secretAccessor"
```

## ğŸ“‹ ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### 1. Google Cloud ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæº–å‚™
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
gcloud projects create your-hibikasu-project

# å¿…è¦ãªAPIã‚’æœ‰åŠ¹åŒ–
gcloud services enable run.googleapis.com
gcloud services enable cloudbuild.googleapis.com
gcloud services enable containerregistry.googleapis.com
gcloud services enable secretmanager.googleapis.com
```

### 2. ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®Dockerãƒ†ã‚¹ãƒˆ
```bash
# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆ
docker build -f backend.Dockerfile -t hibikasu-backend .
docker run -p 8080:8080 \
  -e GOOGLE_API_KEY=your_key \
  hibikasu-backend

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆ
docker build -f frontend.Dockerfile -t hibikasu-frontend .
docker run -p 3000:3000 \
  -e NEXT_PUBLIC_API_BASE_URL=http://localhost:8080 \
  hibikasu-frontend
```

### 3. Cloud Runãƒ‡ãƒ—ãƒ­ã‚¤
```bash
# Cloud Buildã§ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤
gcloud builds submit --config cloudbuild.yaml .

# ã¾ãŸã¯æ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤
gcloud run deploy hibikasu-backend \
  --source . \
  --region asia-northeast1 \
  --allow-unauthenticated
```

## ğŸ“Š ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Š

### Cloud Runæ–™é‡‘ (æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³)
- **CPU**: $0.000024/vCPUç§’
- **ãƒ¡ãƒ¢ãƒª**: $0.0000025/GBç§’
- **ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**: $0.0000004/ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
- **ç„¡æ–™æ **: 200ä¸‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/æœˆã€36ä¸‡vCPUç§’/æœˆ

### æƒ³å®šä½¿ç”¨é‡ (ãƒãƒƒã‚«ã‚½ãƒ³æœŸé–“)
- ãƒ‡ãƒ¢ãƒ»ãƒ†ã‚¹ãƒˆ: ~1000ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/æ—¥
- **æœˆé¡è²»ç”¨**: ~$5-10 (ç„¡æ–™æ å†…)

## ğŸ“ æå‡ºç‰©æº–å‚™

### 1. GitHubå…¬é–‹ãƒªãƒã‚¸ãƒˆãƒª
- [ ] ãƒªãƒã‚¸ãƒˆãƒªã‚’å…¬é–‹ã«å¤‰æ›´
- [ ] README.mdæ›´æ–°ï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †å«ã‚€ï¼‰
- [ ] ãƒ‡ãƒ—ãƒ­ã‚¤ç”¨ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ 

### 2. Zennè¨˜äº‹ä½œæˆé …ç›®
#### å¿…é ˆå†…å®¹:
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼åƒã¨èª²é¡Œ**: PMã‚„ãƒãƒ¼ã‚±ã‚¿ãƒ¼å‘ã‘ã®é«˜å“è³ªPRDãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹
- **ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³**: 9ç¨®é¡ã®å°‚é–€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã‚ˆã‚‹ãƒãƒ«ãƒã‚¢ãƒ³ã‚°ãƒ«åˆ†æ
- **ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³**: Cloud Run + Gemini APIæ§‹æˆ
- **3åˆ†ãƒ‡ãƒ¢å‹•ç”»**: YouTubeå…¬é–‹ â†’ ZennåŸ‹ã‚è¾¼ã¿

#### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ä¾‹:
```
[ãƒ¦ãƒ¼ã‚¶ãƒ¼] â†’ [Next.js Frontend (Cloud Run)]
                â†“ API Call
           [FastAPI Backend (Cloud Run)]
                â†“ ADK Integration
           [Gemini API (9 AI Agents)]
                â†“ Analysis Results
           [æ§‹é€ åŒ–ã•ã‚ŒãŸå°‚é–€å®¶ãƒ¬ãƒ“ãƒ¥ãƒ¼]
```

### 3. ãƒ‡ãƒ¢å‹•ç”»æ§‹æˆæ¡ˆ
1. **å•é¡Œæèµ·** (30ç§’): PRDãƒ¬ãƒ“ãƒ¥ãƒ¼ã®èª²é¡Œ
2. **ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ç´¹ä»‹** (30ç§’): 9ç¨®é¡ã®AIå°‚é–€å®¶
3. **å®Ÿéš›ã®ãƒ‡ãƒ¢** (90ç§’): ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé¸æŠâ†’ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿè¡Œâ†’çµæœç¢ºèª
4. **ä¾¡å€¤ã¾ã¨ã‚** (30ç§’): å°å…¥åŠ¹æœ

## âš ï¸ æ³¨æ„äº‹é …

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- Gemini API Keyã¯çµ¶å¯¾ã«ã‚³ãƒ¼ãƒ‰ã«å«ã‚ãªã„
- Secret Managerä½¿ç”¨æ¨å¥¨
- CORSè¨­å®šã‚’æœ¬ç•ªURLç”¨ã«æ›´æ–°

### æ€§èƒ½
- Cloud Runã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆå¯¾ç­–ï¼ˆkeep-aliveè¨­å®šï¼‰
- Gemini APIãƒ¬ãƒ¼ãƒˆåˆ¶é™è€ƒæ…®
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®é™çš„ã‚¢ã‚»ãƒƒãƒˆæœ€é©åŒ–

### é‹ç”¨
- ãƒ­ã‚°ç›£è¦–è¨­å®š
- ã‚¨ãƒ©ãƒ¼é€šçŸ¥è¨­å®š
- ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®å‹•ä½œç¢ºèªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

## ğŸ¯ å®Ÿè£…å„ªå…ˆåº¦

### Phase 1: åŸºæœ¬ãƒ‡ãƒ—ãƒ­ã‚¤ (æœ€å„ªå…ˆ)
1. Dockerãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
2. Cloud Runãƒ‡ãƒ—ãƒ­ã‚¤
3. åŸºæœ¬å‹•ä½œç¢ºèª

### Phase 2: æœ¬æ ¼é‹ç”¨æº–å‚™
1. Secret Managerçµ±åˆ
2. ç›£è¦–ãƒ»ãƒ­ã‚°è¨­å®š
3. CORSãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–

### Phase 3: æå‡ºæº–å‚™
1. ãƒªãƒã‚¸ãƒˆãƒªå…¬é–‹
2. Zennè¨˜äº‹åŸ·ç­†
3. ãƒ‡ãƒ¢å‹•ç”»ä½œæˆ

æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¨ã—ã¦ã€ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ä½œæˆã‚’å§‹ã‚ã¾ã™ã‹ï¼Ÿ
