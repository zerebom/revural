# サマリーページ実装方針書 (ハッカソンMVP - 改訂版 v2)

## 1. MVPにおけるゴール

サマリーページがMVPで達成すべきゴールは、以下の体験をデモで審査員に提供することである。

> **「AIとの対話プロセスが、いかにしてPdMの不安を自信に変えるか、その”Aha!”モーメントを追体験できること」**

技術的実現性とパフォーマンスを担保しつつ、AIが情報を分析・可視化してくれたという「驚き」と「価値」を直感的に伝えることを最優先とする。

---

## 2. 実装スコープ（最終版）

### 2.1. 基本機能 (MUST HAVE)

- **レイアウト:**
  - ユーザーが縦にスクロールするだけで全ての情報を閲覧できる、シンプルなシングルカラムレイアウトを採用する。
  - レビュー画面で整理されたタイポグラフィ/レイアウトの原則（ボーダーレス、余白、`typ-*`）を継承し、トンマナを統一する。
- **ヘッダー:**
  - サマリーページ専用のヘッダーを設ける。
  - 構成要素は `[< レビューに戻る]` ボタンと `[Markdownとしてエクスポート]` ボタンの2つに限定する。
- **コンテンツ:**
  - **初回AIコメントの表示:** 各指摘カードには、AIによる最初のコメントを表示する。
  - **チャット履歴の段階的表示:** 全チャット履歴は**デフォルトで折りたたみ**、「さらに表示」などの操作でオンデマandに展開する。
- **エクスポート機能:**
  - MVPでは統計情報と各指摘の初回コメントを対象とする。

### 2.2. WOW!体験 (本線スコープ)

- **インタラクティブな統計チャート:**
  - **`shadcn/ui` のチャートコンポーネント (`Recharts`ベース) の導入を本線とする。** これにより、低コストでデザイン一貫性の取れた高品質なUIを実現する。
  - 表示項目: 担当エージェント別の指摘件数 (`BarChart`)、ステータス別の件数 (`PieChart`)。
- **動的生成アニメーション:**
  - `framer-motion` の `staggerChildren` によるフェードイン程度に留め、パフォーマンスを優先する。

---

## 3. 実装計画と依存関係

### 3.1. バックエンド (最優先ブロッカー)
- **`GET /reviews/{id}/summary` の新設:**
  - **責務:** サマリーページに必要な集計データを返す。
  - **返却データ:**
    - `statistics`: チャート実装に必要な集計値（総件数, ステータス別件数, エージェント別件数）。
    - `issues`: 指摘事項の配列。
    - `chat_history`: (将来対応) 現状は空配列を返す。

### 3.2. フロントエンド (API完了後に着手)
- **`shadcn/ui` チャートの導入:**
  - `npx shadcn-ui@latest add charts` を実行し、依存関係を追加する。
  - 公式サイトのサンプルをベースに、`BarChart`と`PieChart`を実装する。
  - **フォールバックプラン:** 万が一、チャート導入で解決困難な問題が発生した場合に限り、簡易的なCSSバーUIに切り替える。
- **Summaryページ本体 (`/reviews/[id]/summary/page.tsx`):**
  - APIをフェッチし、トップダウンで情報を表示する。
    1.  **統計チャートエリア:** `shadcn/ui`のチャートコンポーネントを配置。
    2.  **指摘カード一覧:** 初回AIコメント＋折りたたみ履歴を表示。
- **エクスポート機能:**
  - クライアントサイドでMarkdown文字列を組み立て、Blobとしてダウンロードさせる。

---

## 4. 情報設計の原則

### 4.1. 「結論から詳細へ」のピラミッド構造

コンテンツの表示順は、「結論 → 詳細 → 根拠（オンデマンド）」で構成する。

1.  **結論 (The Point): インタラクティブな統計チャート**
    - ユーザーはページを開いて最初に、レビュー結果の**「要約」**を視覚的に把握する。
2.  **詳細 (The Body): 指摘事項一覧（初回コメント）**
    - 全体像を把握した後、各指摘の具体的な内容へとドリルダウンする。
3.  **根拠 (The Context): チャット履歴（折りたたみ）**
    - 思考プロセスに興味がある場合のみ、ユーザーは自発的に履歴を展開して確認できる。

この情報設計により、ユーザーは初期表示のパフォーマンスを損なうことなく、トップダウンでスムーズに内容を理解できる体験を提供する。
